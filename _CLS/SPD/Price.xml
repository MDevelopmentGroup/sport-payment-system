<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="SPD.Price">
<Super>%Persistent</Super>
<TimeCreated>63393,57121.285694</TimeCreated>

<UDLText name="T">
<Content><![CDATA[
// Property TypeLesson As SPD.TypeLesson;

]]></Content>
</UDLText>

<Property name="Cost">
<Type>%Float</Type>
</Property>

<Property name="DateActualStart">
<Type>%DateTime</Type>
</Property>

<Property name="DateActualEnd">
<Type>%DateTime</Type>
</Property>

<UDLText name="T">
<Content><![CDATA[
// Relationship Semester As SPD.Semester [ Cardinality = many, Inverse = Price ];??????????????

]]></Content>
</UDLText>

<Property name="school">
<Type>SPD.School</Type>
</Property>

<Property name="SubscriptionList">
<Type>SPD.SubscriptionList</Type>
</Property>

<Property name="Actual">
<Type>%Boolean</Type>
<Calculated>1</Calculated>
<SqlComputeCode>set {Actual}=##class(SPD.Price).SetActual({DateActualEnd})</SqlComputeCode>
<SqlComputed>1</SqlComputed>
</Property>

<Method name="SetActual">
<ClassMethod>1</ClassMethod>
<FormalSpec>DateActualEnd</FormalSpec>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	set bl=1
	//w "now="_$zdt($h,3),!
	//w "DateActualEnd="_DateActualEnd,!
	set nowdate=$list($listfromstring($h,","),1)
	set nowtime=$list($listfromstring($h,","),2)

	set actdate=$list($listfromstring($zdatetimeh(DateActualEnd,3),","),1)
	set acttime=$list($listfromstring($zdatetimeh(DateActualEnd,3),","),2)
	//w "nowdate="_nowdate_"     nowtime="_nowtime,!
	//w "actdate="_actdate_"     acttime="_acttime,!
	if (nowdate>actdate)
	{
		set bl=0
	}
	elseif ((nowtime>acttime)&(nowdate>actdate) )
	{
		set bl=0
	}
	ret bl
]]></Implementation>
</Method>

<Method name="Create">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
</Method>

<Method name="Remove">
<ClassMethod>1</ClassMethod>
<FormalSpec>IdPrice</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set st=$$$OK
	try{
		
	}
	catch ex{
		
	}
	ret st
]]></Implementation>
</Method>

<Property name="MatchPrice">
<Type>SPD.MatchPriceTypeLess</Type>
<Cardinality>many</Cardinality>
<Inverse>Price</Inverse>
<Relationship>1</Relationship>
</Property>

<Storage name="Default">
<Type>%Library.CacheStorage</Type>
<DataLocation>^SPD.PriceD</DataLocation>
<DefaultData>PriceDefaultData</DefaultData>
<IdLocation>^SPD.PriceD</IdLocation>
<IndexLocation>^SPD.PriceI</IndexLocation>
<StreamLocation>^SPD.PriceS</StreamLocation>
<ExtentSize>100000</ExtentSize>
<Data name="PriceDefaultData">
<Value name="1">
<Value>%%CLASSNAME</Value>
</Value>
<Value name="2">
<Value>TypeLesson</Value>
</Value>
<Value name="3">
<Value>Cost</Value>
</Value>
<Value name="4">
<Value>DateActualStart</Value>
</Value>
<Value name="5">
<Value>DateActualEnd</Value>
</Value>
<Value name="6">
<Value>Semester</Value>
</Value>
<Value name="7">
<Value>school</Value>
</Value>
<Value name="8">
<Value>Actual</Value>
</Value>
<Value name="9">
<Value>MatchTypeLess</Value>
</Value>
<Value name="10">
<Value>SubscriptionList</Value>
</Value>
</Data>
</Storage>
</Class>
</Export>
